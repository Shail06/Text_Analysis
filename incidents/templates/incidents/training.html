<div class="col-lg-7" id="single_incident">

	<script type='text/javascript'>
		

		$(function(){

			$(".accept").click(function( event ) {
		
				var warn = confirm('Are you Sure?');
				if(warn == true)
				{
					console.log("Yessss")
					event.preventDefault();
					var summary = $('#summary').val();
					var label =  $(this).parent().prev().prev().find("input").val();
					console.log(summary);
					console.log(label);
					$.ajax({
						    url: "/incidents/ajax/",
						    type: "POST",
						    headers: {'X-CSRFToken': '{{ csrf_token }}'},
						    data: { incident_summary : summary, predicted_label : label },
						    dataType: 'json',
						    success: function(data) {
						      console.log(data);
						    },
						    error: function (textStatus, errorThrown) {
				                console.log(textStatus);
				                console.log(errorThrown);
				            }
						  });
				}
			});
		});
			
	</script>
	{% if output_detail %}
		{% csrf_token %}
		<p><b>Incident ID: </b><span style=" font-family: 'Courier New', 'sans-serif';">{{ output_detail.0.0 }}</font></p>
		<p><b>Description: </b>
			<div style="overflow-y: auto; overflow-x: hidden;  font-family: 'Courier New', 'sans-serif'; font-size: 14px; height: 150px; padding-left: 5px; padding-top: 5px; background-color: WhiteSmoke; " >
				{% autoescape on %}
				{{ output_detail.0.1 | linebreaksbr }}
				{% endautoescape %}
			</div>
		</p>


	<p><b>Summary: </b><div><textarea id="summary" name="incident_summary" style="overflow-y: auto; overflow-x: hidden;  font-family: 'Courier New', 'sans-serif'; font-size: 14px; height: 80px; resize: none; width: 100%"  contenteditable >{{ output_detail.0.2 }}</textarea></div></p>


	<p><b>Predictions: </b></p>

	<table width="100%">
		{% for label, prob in predictions %}
			
			<tr>
				<td width="60%">
					<span style=" font-family: 'Courier New', 'sans-serif'; font-size:14px" >{{ label }}</span>
					<input type="hidden" class="{{label}}" name="predicted_label" value="{{ label }}" />
				</td>
				<td width="100%">
					<span name="probability" style=" font-family: 'Courier New', 'sans-serif'; font-size:14px">{{ prob }}%</span>
				</td>
				<td>
					<button class="btn btn-default btn-sm accept" type="submit" name="accept"  id="accept" style=" font-family: 'Courier New', 'sans-serif'; font-size:14px" >
					<span class="glyphicon glyphicon-ok"></span> Accept</button>
				</td>
			</tr>
			
		{% endfor %}
	</table>
	<span class="step-links">
		<div>
			<ul class="pagination justify-content-center">
				{% if output_detail.has_previous %}
					<li class="page-item" >
						<a class="page-link" href="?page={{ output_detail.previous_page_number }}">
							&laquo;&nbsp;Previous
						</a>
					</li>
				{% endif %}
				<li class="page-item active"><a class="page-link" href="#">Page {{ output_detail.number }} of {{ output_detail.paginator.num_pages }} </a></li>
				{% if output_detail.has_next %}
					<li class="page-item">
						<a class="page-link" href="?page={{ output_detail.next_page_number }} ">
							Next&nbsp;&raquo;
						</a>
					</li>
				{% endif %}
			</ul>
		</div>
	</span>
{% endif %}
</div>